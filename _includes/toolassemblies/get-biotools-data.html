{% assign biotools_id = include.biotools_id %}
{% include toolassemblies/biotools-display-table.html %}

<script src="{{ '/assets/js/getBiotoolsData.js' | relative_url }}"></script>
<script>
    // Parse the bio.tools data
    function parse(data) {
        return {
            version: (data.version && data.version.length > 0) ? data.version : 'Version not available',
            publication: data.publication?.map(pub => pub.doi).filter(Boolean) || []
        };
    }

    // Render the data in a table
    function renderTable(parsedData) {
        const version_container = document.getElementById('version');
        const publication_container = document.getElementById('publication');
        const openebench_container = document.getElementById('openebench');

        // Version
        version_container.innerText = parsedData.version;

        // Publications
        if (parsedData.publication.length > 0) {
            publication_container.innerHTML = parsedData.publication.map(doi =>
                `<a href="https://doi.org/${doi}" target="_blank">${doi}</a>`
            ).join('<br>');
        } else {
            publication_container.innerText = 'No publications available';
        }

        // Openebench link
        openebench_container.innerHTML = `
            <a href="https://openebench.bsc.es/tool/{{ biotools_id }}" target="_blank">statistics</a>
        `;
    }

    // Get the data of the tools with the desired ID
    getBiotoolsData("{{ biotools_id }}")
        .then(data => {
            const parsedData = parse(data);
            renderTable(parsedData);
        })
        .catch(error => {
            console.error(error);
            document.getElementById('biotools-data-container').innerHTML =
                '<p class="text-danger">Failed to load bio.tools data.</p>';
        });
</script>